<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9389705</versionUuid>
    <interface>
        <name>SCDO_Boton_Exportar_Excel_Reportes_NO_DOCUM</name>
        <uuid>_a-0000ea61-526a-8000-e65e-01ef9001ef90_7603016</uuid>
        <description>Muestra la funcionalidad para exportar el cat√°logo excel de la funcionalidad NO DOCUMENTAL</description>
        <parentUuid>_a-0000e801-560f-8000-e5d9-01ef9001ef90_1707049</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>a!localVariables(
  local!usuariosPorSegmento,
  local!ccostosNoBD,
  local!centrosPorRegion,
  local!usuarioSeleccionado,
  
  {
    if(
      isnull(ri!documento_doc),
      {
        #"SYSTEM_SYSRULES_ButtonArrayLayout"(
          buttons: {
            #"SYSTEM_SYSRULES_ButtonWidget"(
              label: "Generar Excel",
              icon: "file-excel-o",
              size: "SMALL",
              loadingIndicator: true,
              style: "LINK",
              saveInto: {
                /*a!save(*/
                  /*local!ccostosNoBD,*/
                  /*if(*/
                    /*a!isNullOrEmpty(*/
                      /*rule!SCDO_obtenerCentroCostosNoRegistrados(ccosto: null)*/
                    /*),*/
                    /*null,*/
                    /*rule!SCDO_obtenerCentroCostosNoRegistrados(ccosto: null).cc*/
                  /*)*/
                /*),*/
                /*a!startProcess(*/
                  /*processModel: cons!SCDO_MODELO_EXPORTAR_EXCEL_REPORTES_PEND_REV,*/
                  /*processParameters: {*/
                    /*KeyGrids: ri!keyGrids,*/
                    /*ccostos: ri!ccostos,*/
                    /*costosNoBD: ri!costosNoBD,*/
                    /*centrosPorRegion: ri!centrosPorRegion,*/
                    /*contrato: ri!contrato,*/
                    /*fechaDividida: ri!fechaDividida,*/
                    /*fechal: ri!fechaFin,*/
                    /*fecha: ri!fechaInicio,*/
                    /*fechaalDividida: ri!fechaalDividida,*/
                    /*llamadaTelefonica: ri!llamadaTelefonica,*/
                    /*noPermitido: ri!noPermitido,*/
                    /*obligatorio: ri!obligatorio,*/
                    /*operacion: ri!operacion,*/
                    /*promotor: ri!promotor,*/
                    /*region: ri!region,*/
                    /*riesgo: ri!riesgo,*/
                    /*tipoReporte: ri!tipoReporte,*/
                    /*usuario: ri!usuario,*/
                    /*usuariosRegistrados: ri!usuariosRegistrados*/
                  /*},*/
                  /*onSuccess: {*/
                    /*a!save(*/
                      /*ri!documento_doc,*/
                      /*fv!processInfo.pv.documento*/
                    /*)*/
                  /*},*/
                  /*onError: "No se puede generar el EXCEL"*/
                /*),*/
                #"SYSTEM_SYSRULES_startProcess"(
                  processModel: #"_a-0000ea61-526a-8000-e65e-01ef9001ef90_7603024",
                  processParameters: {
                    segmento:if(a!isNotNullOrEmpty(ri!segmento),#"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2233353"(idSegmento: ri!segmento).data[1].segmento,null),
                    keyGrids: ri!keyGrids,
                    ccostos: ri!ccostos,
                    /*ccostosNoDB: ri!costosNoBD,*/
                    /*centrosPorRegion: ri!centrosPorRegion,*/
                    contrato: ri!contrato,
                    fechaDividida: ri!fechaDividida,
                    fechal: ri!fechaFin,
                    fecha: ri!fechaInicio,
                    fechaalDividida: ri!fechaalDividida,
                    llamadaTelefonica: ri!llamadaTelefonica,
                    noPermitido: ri!noPermitido,
                    obligatorio: ri!obligatorio,
                    operacion: ri!operacion,
                    promotor: ri!promotor,
                    region: ri!region,
                    riesgo: ri!riesgo,
                    /*tipoReporte: ri!tipoReporte,*/
                    usuario: ri!usuario,
                    /*usuariosRegistrados: ri!usuariosRegistrados*/
                  },
                  onSuccess: {
                    a!save(
                      ri!documento_doc,
                      fv!processInfo.pv.documento
                    )
                  },
                  onError: "No se puede generar el EXCEL"
                ),
              },
              tooltip: if(
                and(a!isNullOrEmpty(ri!ccostos),a!isNullOrEmpty(ri!contrato),a!isNullOrEmpty(ri!fechaalDividida),a!isNullOrEmpty(ri!fechaFin),a!isNullOrEmpty(ri!fechaDividida),a!isNullOrEmpty(ri!fechaInicio),a!isNullOrEmpty(ri!keyGrids),a!isNullOrEmpty(ri!llamadaTelefonica),a!isNullOrEmpty(ri!noPermitido),a!isNullOrEmpty(ri!obligatorio),a!isNullOrEmpty(ri!operacion),a!isNullOrEmpty(ri!promotor),a!isNullOrEmpty(ri!region),a!isNullOrEmpty(ri!usuario),a!isNullOrEmpty(ri!riesgo),a!isNullOrEmpty(ri!segmento),),
                "Para Generar Excel debe Filtrar",
                "Generar Excel"
              ),
              disabled: and(a!isNullOrEmpty(ri!ccostos),a!isNullOrEmpty(ri!contrato),a!isNullOrEmpty(ri!fechaalDividida),a!isNullOrEmpty(ri!fechaFin),a!isNullOrEmpty(ri!fechaDividida),a!isNullOrEmpty(ri!fechaInicio),a!isNullOrEmpty(ri!keyGrids),a!isNullOrEmpty(ri!llamadaTelefonica),a!isNullOrEmpty(ri!noPermitido),a!isNullOrEmpty(ri!obligatorio),a!isNullOrEmpty(ri!operacion),a!isNullOrEmpty(ri!promotor),a!isNullOrEmpty(ri!region),a!isNullOrEmpty(ri!usuario),a!isNullOrEmpty(ri!riesgo),a!isNullOrEmpty(ri!segmento),)
            )  
          },
          align: "START"
        ),
       
      },
      #"SYSTEM_SYSRULES_richTextDisplayField"(
        value: #"SYSTEM_SYSRULES_richTextItem_v1"(
          text: {
            #"SYSTEM_SYSRULES_richTextIcon"(icon: "download", size: "MEDIUM"),
            "DESCARGAR EXCEL"
          },
          link: #"SYSTEM_SYSRULES_documentDownloadLink"(document: ri!documento_doc),
          linkStyle: "STANDALONE",
          style: "STRONG",
          color: "#cc0000"
        )
      )

    )
  }
)
/*a!localVariables(*/
  /*local!usuariosPorSegmento,*/
  /*local!ccostosNoBD,*/
  /*local!centrosPorRegion,*/
  /*local!usuarioSeleccionado,*/
/**/
  /*{*/
    /*if(*/
      /*isnull(ri!documento_doc),*/
      /*a!richTextDisplayField(*/
        /*value: a!richTextItem(*/
          /*text: {*/
            /*a!richTextIcon(icon: "file-excel-o", size: "MEDIUM"),*/
            /*"GENERAR EXCEL"*/
          /*},*/
          /*link: a!dynamicLink(*/
            /*saveInto: {*/
              /*a!save(*/
                /*local!ccostosNoBD,*/
                /*if(*/
                  /*a!isNullOrEmpty(*/
                    /*rule!SCDO_obtenerCentroCostosNoRegistrados(ccosto: null)*/
                  /*),*/
                  /*null,*/
                  /*rule!SCDO_obtenerCentroCostosNoRegistrados(ccosto: null).cc*/
                /*)*/
              /*),*/
              /*a!startProcess(*/
              /*processModel: cons!SCDO_MODELO_EXPORTAR_EXCEL_REPORTES_NO_docum,*/
              /*processParameters: {*/
              /*KeyGrids: ri!keyGrids,*/
              /*ccostos: ri!ccostos,*/
              /*costosNoBD: ri!costosNoBD,*/
              /*centrosPorRegion: ri!centrosPorRegion,*/
              /*contrato: ri!contrato,*/
              /*fechaDividida: ri!fechaDividida,*/
              /*fechal: ri!fechaFin,*/
              /*fecha: ri!fechaInicio,*/
              /*fechaalDividida: ri!fechaalDividida,*/
              /*llamadaTelefonica: ri!llamadaTelefonica,*/
              /*noPermitido: ri!noPermitido,*/
              /*obligatorio: ri!obligatorio,*/
              /*operacion: ri!operacion,*/
              /*promotor: ri!promotor,*/
              /*region: ri!region,*/
              /*riesgo: ri!riesgo,*/
              /*tipoReporte: ri!tipoReporte,*/
              /*usuario: ri!usuario,*/
              /*usuariosRegistrados: ri!usuariosRegistrados*/
              /*},*/
              /*onSuccess: {*/
              /*a!save(*/
              /*ri!documento_doc,*/
              /*fv!processInfo.pv.documento*/
              /*)*/
              /*},*/
              /*onError: "No se puede generar el EXCEL"*/
              /*),*/
            /*}*/
          /*),*/
          /*linkStyle: "STANDALONE",*/
          /*style: "STRONG",*/
          /*color: "#cc0000"*/
        /*)*/
      /*),*/
      /*a!richTextDisplayField(*/
        /*value: a!richTextItem(*/
          /*text: {*/
            /*a!richTextIcon(icon: "download", size: "MEDIUM"),*/
            /*"DESCARGAR EXCEL"*/
          /*},*/
          /*link: a!documentDownloadLink(document: ri!documento_doc),*/
          /*linkStyle: "STANDALONE",*/
          /*style: "STRONG",*/
          /*color: "#cc0000"*/
        /*)*/
      /*)*/
/**/
    /*)*/
  /*}*/
/*)*/</definition>
        <namedTypedValue>
            <name>documento_doc</name>
            <type>
                <name>CollaborationDocument</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>ccostos</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>contrato</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>fechaDividida</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>fechaFin</name>
            <type>
                <name>date</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>fechaInicio</name>
            <type>
                <name>date</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>fechaalDividida</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>keyGrids</name>
            <type>
                <name>Integer?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>costosNoBD</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>centrosPorRegion</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>llamadaTelefonica</name>
            <type>
                <name>Integer?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>noPermitido</name>
            <type>
                <name>Integer?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>obligatorio</name>
            <type>
                <name>Integer?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>operacion</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>promotor</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>region</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>tipoReporte</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>usuario</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>usuariosRegistrados</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>riesgo</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>segmento</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
        <isCustom>false</isCustom>
    </interface>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name/>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="a:CollaborationDocument"/>
                    <a:nameRef>documento_doc</a:nameRef>
                    <a:id>1</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>ccostos</a:nameRef>
                    <a:id>2</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">"56510231282"</a:value>
                    <a:nameRef>contrato</a:nameRef>
                    <a:id>3</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>fechaDividida</a:nameRef>
                    <a:id>4</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:date"/>
                    <a:nameRef>fechaFin</a:nameRef>
                    <a:id>5</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:date"/>
                    <a:nameRef>fechaInicio</a:nameRef>
                    <a:id>6</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>fechaalDividida</a:nameRef>
                    <a:id>7</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>keyGrids</a:nameRef>
                    <a:id>8</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>costosNoBD</a:nameRef>
                    <a:id>9</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>centrosPorRegion</a:nameRef>
                    <a:id>10</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>llamadaTelefonica</a:nameRef>
                    <a:id>11</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>noPermitido</a:nameRef>
                    <a:id>12</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>obligatorio</a:nameRef>
                    <a:id>13</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>operacion</a:nameRef>
                    <a:id>14</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>promotor</a:nameRef>
                    <a:id>15</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>region</a:nameRef>
                    <a:id>16</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">1</a:value>
                    <a:nameRef>tipoReporte</a:nameRef>
                    <a:id>17</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>usuario</a:nameRef>
                    <a:id>18</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:nameRef>usuariosRegistrados</a:nameRef>
                    <a:id>19</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:int"/>
                    <a:nameRef>riesgo</a:nameRef>
                    <a:id>20</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:int"/>
                    <a:nameRef>segmento</a:nameRef>
                    <a:id>21</a:id>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000eaa5-8248-8000-e681-01ef9001ef90_8208559"/>
        <historyInfo versionUuid="_a-0000eae4-5659-8000-e685-01ef9001ef90_8672634"/>
        <historyInfo versionUuid="_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9389705"/>
    </history>
</contentHaul>
