<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9470546</versionUuid>
    <interface>
        <name>SCDO_CorreccionDatosReportesPorOperacion</name>
        <uuid>_a-0000e9a7-6d42-8000-e63f-01ef9001ef90_5589289</uuid>
        <description>Regla de interfaz que muestra las operaciones de la tabla de reportes dada una operacion para que se le realicen las modificaciones</description>
        <parentUuid>_a-0000e801-560f-8000-e5d9-01ef9001ef90_1707049</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>a!localVariables(
  local!eliminar: false,
  local!editar: {-1,0},
  local!operacionEditar,
  local!operacionEditada,
  local!indiceEditar,
  local!obligatorioSeleccionado,
  local!idusuarioopics1,
  local!idusuarioopics2,
  local!idusuarioopics3,
  local!ejecutivo,
  local!supervisor,
  local!administrador,
  local!idcentrocostos,
  local!mostrarConfirmacion: false,
  local!mostrarExportacion: false,
  local!usuario: loggedInUser(),
  local!nombre,
  local!excel,
  local!fecha_reviso_aux,
  local!fecha_captura_aux,
  
  {
    #"SYSTEM_SYSRULES_columnsLayout"(
      columns: {
        #"SYSTEM_SYSRULES_columnLayout"(
          contents: {},
          width: "AUTO"
        ),
        #"SYSTEM_SYSRULES_columnLayout"(
          contents: {
            #"SYSTEM_SYSRULES_cardLayout"(
              contents: {
                #"SYSTEM_SYSRULES_richTextDisplayField"(
                  value: {
                    #"SYSTEM_SYSRULES_richTextItem_v1"(
                      text: concat("¿Está seguro de que desa eliminar esta Operación?", char(10), "La acción es irrevocable"),
                      color: "NEGATIVE"
                    )
                  },
                  align: "CENTER"
                ),

                #"SYSTEM_SYSRULES_ButtonLayout"(
                  primaryButtons: {
                    #"SYSTEM_SYSRULES_ButtonWidget"(
                      label: "Eliminar",
                      icon: "times",
                      tooltip: "Eliminar definitivamente",
                      saveInto: {
                        #"SYSTEM_SYSRULES_startProcess"(
                          processModel: #"_a-0000e9a7-6d42-8000-e63f-01ef9001ef90_5292884",
                          processParameters: {
                            reporte: #"_a-0000e8d8-9b98-8000-e605-01ef9001ef90_2933354"(idreporte: local!operacionEditar.idreporte),
                            delete: local!eliminar,
                            es_aprobado: false,
                            reporte_aprobado: null,
                          },
                          onSuccess: "Se ha eliminado la Operación",
                          onError: "Ha ocurrido un error"
                        ),
                        a!save(local!eliminar, false),
                        a!save(ri!operacion, null),
                        a!save(ri!operacionesReportes, remove(ri!operacionesReportes, local!indiceEditar)),
                        a!save(local!operacionEditar, null)
                      },
                      size: "SMALL",
                      width: "MINIMIZE",
                      style: "DESTRUCTIVE",
                      loadingIndicator: true
                    )
                  },
                  secondaryButtons: {
                    #"SYSTEM_SYSRULES_ButtonWidget"(
                      label: "Cancelar",
                      icon: "times",
                      tooltip: "Cancelar",
                      saveInto: {
                        a!save(local!eliminar, false)
                      },
                      size: "SMALL",
                      width: "MINIMIZE",
                      style: "SECONDARY"
                    )
                  }
                )
              },
              showWhen: {
                if(
                  not(local!eliminar),
                  false,
                  true
                )
              },
              style: "WARN",
              shape: "SEMI_ROUNDED",
              padding: "EVEN_LESS",
              marginAbove: "EVEN_LESS",
              showBorder: false

            )
          },
          width: "MEDIUM"
        )
      }
    ),
    #"SYSTEM_SYSRULES_gridLayout"(
      label: "Información de Reporte",
      labelPosition: "ABOVE",
      emptyGridMessage: "No Hay Información",
      headerCells: {
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Riesgo"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Obligatorio"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Revisado"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Promotor"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Operacion"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Contrato"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Usuario"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Nom-Usu"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Segmento"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Nombre del cliente"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Montos de operación"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Emisora"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "C/V"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Mercado"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Centro de Costo"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Fecha Captura"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Hora Captura"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Usuario Reviso"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Fecha Reviso"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Observaciones"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "IP"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Bitacora",
          align:"CENTER"
        ),
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Título"
        ),
        /*a!gridLayoutHeaderCell(*/
          /*label: "C/V"*/
        /*),*/
        #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(
          label: "Acciones"
        )

      },
      showWhen: {if(a!isNullOrEmpty(ri!operacionesReportes), false, true)},
      columnConfigs: {},
      rows: #"SYSTEM_SYSRULES_forEach"(
        ri!operacionesReportes,
        #"SYSTEM_SYSRULES_gridRowLayout"(
          contents: {
            /*a!dropdownField(*/
              /*label: "Riesgo",*/
              /*labelPosition: "ABOVE",*/
              /*placeholder: "--- Select a Value ---",*/
              /*choiceLabels: { "R.ALTO", "R.BAJO", "R.MEDIO" },*/
              /*choiceValues: { 1, 2, 3 },*/
              /*value: fv!item.riesgo,*/
              /*saveInto: { fv!item.riesgo },*/
              /*searchDisplay: "AUTO",*/
              /*disabled: {*/
                /*if(*/
                  /*and(local!editar[1] = fv!index, local!editar[2] = 1),*/
                  /*false, */
                  /*true*/
                /*)*/
              /*},*/
              /*validations: {}*/
            /*),*/
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Riesgo",
              value: if(a!isNotNullOrEmpty(fv!item.riesgo),
              if(fv!item.riesgo=1,"R.ALTO",
              if(fv!item.riesgo=2,"R.MEDIO","R.BAJO"))
              ,"Sin Riesgo"),
              /*saveInto: fv!item.riesgo,*/
              readOnly: true,
              /*disabled: */

            ),
            #"SYSTEM_SYSRULES_checkboxField"(
              choiceLabels: {
                if(/*a!isNotNullOrEmpty(fv!item.obligatorio)*/fv!item.obligatorio="*", "Obligatorio", "No Obligatorio")
              },
              choiceValues: {"*"},
              value: if(fv!item.obligatorio&lt;&gt;"*",null,fv!item.obligatorio),
              saveInto: {
                local!obligatorioSeleccionado,
                a!save(fv!item.obligatorio, if(isnull(local!obligatorioSeleccionado), "", local!obligatorioSeleccionado))
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            /*a!radioButtonField(*/
              /*label: "",*/
              /*labelPosition: "ABOVE",*/
              /*choiceLabels: {"Obligatorio", "No Obligatorio"},*/
              /*choiceValues: { "*"," " },*/
              /*value: {fv!item.obligatorio },*/
              /*saveInto: { local!obligatorioSeleccionado },*/
              /*choiceLayout: "STACKED",*/
              /*validations: {*/
              /*}*/
            /*),*/
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Revisado",
              value: fv!item.revisado,
              saveInto: fv!item.revisado,
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
            ),
            #"SYSTEM_SYSRULES_dropdownField_v1"(
              label: "Promotor",
              choiceLabels: {
                index(ri!usuariosopics,"usuarioopics",{}), "Sin Promotor"
              },
              choiceValues:{
                index(ri!usuariosopics,"idusuarioopics",{}), "Sin Promotor"
              },
              value: if(isnull(fv!item.promotor), "Sin Promotor", if(a!isNullOrEmpty(#"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(usuarioOpic: fv!item.promotor).data), "Sin Promotor", #"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(usuarioOpic: fv!item.promotor).data[1].idusuarioopics)),
              saveInto: {
                local!idusuarioopics1,
                a!save(fv!item.promotor, #"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(idUsuarioOpic: local!idusuarioopics1).data[1].usuarioopics)
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_textField"(

              label: "Operacion",
              refreshAfter: "KEYPRESS",
              value: fv!item.operacion,
              saveInto: {
                fv!item.operacion,
                /*a!save(*/
                  /*fv!item.operacion,*/
                  /*rule!SCDO_QUITAR_LETRAS(texto:fv!item.operacion)*/
                /*)*/
              },
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },

            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Contrato",
              value: fv!item.contrato,
              saveInto: {
                fv!item.contrato,
                /*a!save(*/
                  /*fv!item.contrato,*/
                  /*rule!SCDO_QUITAR_LETRAS(texto:fv!item.contrato)*/
                /*)*/
              },
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },

            ),
            #"SYSTEM_SYSRULES_dropdownField_v1"(
              label: "Usuario",
              choiceLabels: {
                index(ri!usuariosopics,"usuarioopics",{})
              },
              choiceValues:{
                index(ri!usuariosopics,"idusuarioopics",{})
              },
              value: if(a!isNotNullOrEmpty(#"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(usuarioOpic:  fv!item.usuario).data),#"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(usuarioOpic:  fv!item.usuario).data[1].idusuarioopics,null),
              saveInto: {
                local!idusuarioopics2,
                a!save(fv!item.usuario, #"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(idUsuarioOpic:  local!idusuarioopics2).data[1].usuarioopics),
                a!save(local!ejecutivo, #"4abb2c14-ac25-4b4a-a0f6-a11f52071c0b"(usuarioopics: fv!item.usuario)),
                a!save(local!supervisor, #"_a-0000e982-d80b-8000-e63b-01ef9001ef90_4617772"(usuario: fv!item.usuario)),
                a!save(local!administrador, #"_a-0000e8b3-d748-8000-e5f3-01ef9001ef90_2402181"(usuario: fv!item.usuario)),
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label:"Nom-Usu",
              value: if(
                a!isNullOrEmpty(#"4abb2c14-ac25-4b4a-a0f6-a11f52071c0b"(usuarioopics: fv!item.usuario).data),
                if(
                  a!isNullOrEmpty(#"_a-0000e982-d80b-8000-e63b-01ef9001ef90_4617772"(usuario: fv!item.usuario).data),
                  if(a!isNullOrEmpty( #"_a-0000e8b3-d748-8000-e5f3-01ef9001ef90_2402181"(usuario: fv!item.usuario).data)," ", #"_a-0000e8b3-d748-8000-e5f3-01ef9001ef90_2402181"(usuario: fv!item.usuario).data[1].nombre,)

                  #"_a-0000e982-d80b-8000-e63b-01ef9001ef90_4617772"(usuario: fv!item.usuario).data[1].nombre
                ),

                #"4abb2c14-ac25-4b4a-a0f6-a11f52071c0b"(usuarioopics: fv!item.usuario).data[1].nombre
              ),
              readOnly: {
                true
              },
              disabled: true
            ),
            /*            Este campo depende del usuario que se escoja*/
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Segmento",
              value: if(a!isNotNullOrEmpty( #"4abb2c14-ac25-4b4a-a0f6-a11f52071c0b"(usuarioopics: fv!item.usuario).data),
              #"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2233353"(idSegmento: #"4abb2c14-ac25-4b4a-a0f6-a11f52071c0b"(usuarioopics: fv!item.usuario).data[1].idsegmento).data[1].segmento
              ,null),
              saveInto: fv!item.segmento,
              readOnly: true,
              disabled: true
            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label:"Nom-Cliente",
              value: fv!item.nombre,
              saveInto: fv!item.nombre,
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_floatingPointField"(
              refreshAfter:"KEYPRESS",
              label:"Monto-Op",
              value: fv!item.monto,
              saveInto: fv!item.monto,
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label:"Emisora",
              value: fv!item.emisora,
              saveInto: fv!item.emisora,
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              align: "CENTER"
            ),
            #"SYSTEM_SYSRULES_dropdownField_v1"(
              label: "Tipo-op",
              placeholder: "Seleccione el Tipo-op",
              choiceLabels: {"Compra", "Venta", "Sin Tipo-op"},
              choiceValues: {"C", "V", "Sin Tipo-op"},
              value:{
                if(isnull(fv!item.extra4), "Sin Tipo-op", fv!item.extra4)
              },
              saveInto: {
                fv!item.extra4
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Mercado",
              value: fv!item.mercado,
              saveInto: fv!item.mercado,
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_dropdownField_v1"(
              label: "Centro de Costo",
              choiceLabels: index(ri!centroCostos,"cc",{}),
              choiceValues: index(ri!centroCostos,"idccostos",{}),
              value: #"_a-0000e8c4-62ba-8000-e603-01ef9001ef90_2682345"(cc: fv!item.ccostos).data[1].idccostos,
              saveInto: {
                local!idcentrocostos,
                a!save(fv!item.ccostos, #"_a-0000e8c4-62ba-8000-e603-01ef9001ef90_2682345"(idccostos: local!idcentrocostos).data[1].cc)
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_dateField"(
              label: "Fecha Captura",
              value: if(a!isNotNullOrEmpty(fv!item.fechacaptura),
              
              date(
                tointeger(left(fv!item.fechacaptura, 4)),
                tointeger(mid(fv!item.fechacaptura, 6, 2)),
                tointeger(mid(fv!item.fechacaptura, 9, 2)),

              ),
              null
              ) , 

              saveInto: {{fv!item.fechacaptura,local!fecha_captura_aux},
              a!save(
                fv!item.fechacaptura,
                if(a!isNullOrEmpty( local!fecha_captura_aux), null, text(date( year(local!fecha_captura_aux),month(local!fecha_captura_aux),day(local!fecha_captura_aux), ), "yyyy-mm-dd 00:00:00")),
              )
              },
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }

            ),
            /*a!textField(*/
              /*label: "Fecha Captura",*/
              /*value: fv!item.fechacaptura,*/
              /*saveInto: fv!item.fechacaptura,*/
              /*readOnly: {*/
                /*if(*/
                  /*and(local!editar[1] = fv!index, local!editar[2] = 1),*/
                  /*false, */
                  /*true*/
                /*)*/
              /*},*/
              /*disabled: {*/
                /*if(*/
                  /*and(local!editar[1] = fv!index, local!editar[2] = 1),*/
                  /*false, */
                  /*true*/
                /*)*/
              /*}*/
            /*),*/
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Hora Captura",
              value: fv!item.horacaptura,
              saveInto: {
                fv!item.horacaptura,
                /*a!save(*/
                /*fv!item.horacaptura,*/
                /*if(rule!SCDO_HAY_LETRAS_EN_HORA(texto:fv!item.horacaptura),*/
                /*null,fv!item.horacaptura)*/
                /*)*/
              },
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              validationGroup: "formato_hora",
              validations: {
                if(or(#"_a-0000eaa5-8248-8000-e681-01ef9001ef90_8193964"(texto:fv!item.horacaptura),#"_a-0000eaa5-8248-8000-e681-01ef9001ef90_8203100"(texto:fv!item.horacaptura)),
                "Formato de la hora incorrecto.",null)
              }
            ),
            #"SYSTEM_SYSRULES_dropdownField_v1"(
              label: "Usuario Reviso",
              placeholder: "Seleccione el usuario",
              choiceLabels: {
                index(ri!usuariosopics,"usuarioopics",{})
              },
              choiceValues:{
                index(ri!usuariosopics,"idusuarioopics",{})
              },
              value:if(a!isNullOrEmpty(#"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(usuarioOpic:  fv!item.usuarioreviso).data), null, #"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(usuarioOpic:  fv!item.usuarioreviso).data[1].idusuarioopics),
              saveInto: {
                local!idusuarioopics3,
                a!save(fv!item.usuario, #"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(idUsuarioOpic:  local!idusuarioopics3).data[1].usuarioopics),
              },
              disabled: true,
              /*{*/
                /*if(*/
                  /*and(local!editar[1] = fv!index, local!editar[2] = 1),*/
                  /*false, */
                  /*true*/
                /*)*/
              /*}*/
            ),
            #"SYSTEM_SYSRULES_dateField"(
              value: if(a!isNotNullOrEmpty(fv!item.fechareviso),
              date(
                tointeger(left(fv!item.fechareviso, 4)),
                tointeger(mid(fv!item.fechareviso, 6, 2)),
                tointeger(mid(fv!item.fechareviso, 9, 2)),

              ),
              null
              ) , 

              saveInto: {{fv!item.fechareviso,local!fecha_reviso_aux},
              a!save(
                fv!item.fechareviso,
                if(a!isNullOrEmpty( local!fecha_reviso_aux), null, text(date( year(local!fecha_reviso_aux),month(local!fecha_reviso_aux),day(local!fecha_reviso_aux), ), "yyyy-mm-dd 00:00:00")),
              )
              },
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }

            ),
            /*a!textField(*/
              /*label:"Fecha Reviso",*/
              /*value: fv!item.fechareviso,*/
              /*saveInto: fv!item.fechareviso,*/
              /*readOnly: {*/
                /*if(*/
                  /*and(local!editar[1] = fv!index, local!editar[2] = 1),*/
                  /*false, */
                  /*true*/
                /*)*/
              /*}*/
            /*),*/
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Observaciones",
              value: fv!item.observaciones,
              saveInto: fv!item.observaciones,
              readOnly: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              },
              disabled: {
                if(
                  and(local!editar[1] = fv!index, local!editar[2] = 1),
                  false, 
                  true
                )
              }
            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "IP",
              value: fv!item.ip,
              saveInto: fv!item.ip,
              readOnly: {
                true
              },
              disabled: {
                true
              }
            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Bitacora",
              value: fv!item.bitacora,
              saveInto: fv!item.bitacora,
              readOnly: {
                true
              },
              disabled: {
                true
              },
              align: "CENTER"
            ),
            #"SYSTEM_SYSRULES_textField"(
              refreshAfter:"KEYPRESS",
              label: "Título",
              value: fv!item.titulo,
              saveInto: fv!item.titulo,
              readOnly: {
                if(
                  and(
                    local!editar[1] = fv!index,
                    local!editar[2] = 1
                  ),
                  false,
                  true
                )
              },
              disabled: {
                if(
                  and(
                    local!editar[1] = fv!index,
                    local!editar[2] = 1
                  ),
                  false,
                  true
                )
              },
              align: "CENTER"
            ),
            /*a!textField(*/
              /*label: "C/V ",*/
              /*value: fv!item.extra4,*/
              /*saveInto: fv!item.extra4,*/
              /*readOnly: {*/
                /*if(*/
                  /*and(*/
                    /*local!editar[1] = fv!index,*/
                    /*local!editar[2] = 1*/
                  /*),*/
                  /*false,*/
                  /*true*/
                /*)*/
              /*},*/
              /*disabled: {*/
                /*if(*/
                  /*and(*/
                    /*local!editar[1] = fv!index,*/
                    /*local!editar[2] = 1*/
                  /*),*/
                  /*false,*/
                  /*true*/
                /*)*/
              /*},*/
              /*align: "CENTER"*/
            /*),*/
            #"SYSTEM_SYSRULES_richTextDisplayField"(
              value: {
                #"SYSTEM_SYSRULES_richTextIcon"(
                  icon: "pen",
                  caption: "Editar",
                  link: #"SYSTEM_SYSRULES_dynamicLink"(
                    label: "Editar",
                    saveInto:{
                      a!save(local!editar[1], fv!index),
                      a!save(local!editar[2], 1),
                      a!save(local!operacionEditar, fv!item),
                      a!save(local!indiceEditar, fv!index)
                    }
                  ),
                  linkStyle: "STANDALONE",
                  showWhen: {
                    if(
                      and(local!editar[1] = -1, local!editar[2] = 0, local!mostrarConfirmacion = false, local!mostrarExportacion = false),
                      true,
                      if(
                        and(not(local!editar[1] = fv!index), local!editar[2] =1),
                        false,
                        if(
                          and(local!editar[1] = fv!index, local!editar[2] = 1),
                          false,
                          if( or(local!mostrarConfirmacion = true, local!mostrarExportacion = true), false, true)
                        )
                      )
                    )
                  },
                  color: "POSITIVE"
                ),
                #"SYSTEM_SYSRULES_richTextIcon"(
                  icon: "pen",
                  caption: "Descartar Cambios",
                  link: #"SYSTEM_SYSRULES_dynamicLink"(
                    label:"Descartar Cambios",
                    saveInto:{
                      a!save(local!editar[1], -1),
                      a!save(local!editar[2], 0),
                      a!save(fv!item, local!operacionEditar),
                      a!save(local!ejecutivo, null),
                      a!save(local!supervisor, null),
                      a!save(local!administrador, null),
                      a!save(local!idusuarioopics1, null),
                      a!save(local!idusuarioopics2, null),
                      a!save(local!eliminar, false)
                    }
                  ),
                  linkStyle: "STANDALONE",
                  showWhen: {
                    if(
                      and(local!editar[1] = fv!index, local!editar[2] = 1),
                      true,
                      false
                    )
                  },
                  color: "SECONDARY"
                ),
                #"SYSTEM_SYSRULES_richTextIcon"(
                  icon: "file-invoice",
                  caption: "Actualizar",
                  link: #"SYSTEM_SYSRULES_dynamicLink"(
                    saveInto: {
                      a!save(local!mostrarConfirmacion, true),
                      a!save(local!operacionEditada, fv!item),
                      a!save(local!editar, {-1, 0}),
                    }
                  ),
                  linkStyle: "STANDALONE",
                  showWhen: {
                    if(
                      and(
                        #"_a-0000eaa5-8248-8000-e681-01ef9001ef90_8193964"(texto:fv!item.horacaptura)=false,
                        #"_a-0000eaa5-8248-8000-e681-01ef9001ef90_8203100"(texto:fv!item.horacaptura)=false,
                        local!editar[1] = fv!index, 
                        local!editar[2] = 1,
                        if(
                          a!isnullOrEmpty(local!operacionEditar),
                          false,
                          if(
                            or(
                              a!isnullOrEmpty(fv!item.promotor),
                              a!isnullOrEmpty(fv!item.usuario),
                              a!isnullOrEmpty(fv!item.operacion),
                              a!isnullOrEmpty(fv!item.contrato),
                              a!isnullOrEmpty(fv!item.nombre)
                            ),
                            false,
                            or(
                              not(local!operacionEditar = fv!item)
                            )
                          )
                        )
                      ),
                      true,
                      false
                    )
                  },
                  color: "ACCENT"
                ),
                #"SYSTEM_SYSRULES_richTextIcon"(
                  icon: "times",
                  caption: "Eliminar",
                  link: #"SYSTEM_SYSRULES_dynamicLink"(
                    saveInto: {
                      a!save(local!eliminar, true),
                      a!save(local!operacionEditar, fv!item),
                      a!save(local!indiceEditar, fv!index)
                    }
                  ),
                  linkStyle: "STANDALONE",
                  showWhen: {
                    not(local!mostrarConfirmacion)
                  },
                  color: "NEGATIVE"
                )
              },
              align: "CENTER"
            )
          }
        )
      ),
      selectionSaveInto: {},
      validations: {},
      shadeAlternateRows: true
    ),
    #"SYSTEM_SYSRULES_columnsLayout"(
      columns: {
        #"SYSTEM_SYSRULES_columnLayout"(),
        #"SYSTEM_SYSRULES_columnLayout"(
          contents: {
            #"SYSTEM_SYSRULES_cardLayout"(
              contents: {
                #"SYSTEM_SYSRULES_richTextDisplayField"(
                  value: {
                    #"SYSTEM_SYSRULES_richTextItem_v1"(
                      text: "Confirmar cambios",
                      color: "STANDARD",
                      size: "MEDIUM_PLUS"
                    )
                  },
                  align: "CENTER"
                ),
                #"SYSTEM_SYSRULES_richTextDisplayField"(
                  value: {
                    #"SYSTEM_SYSRULES_richTextItem_v1"(
                      text: "Los cambios confirmados se guardarán persistentemente.",
                      style: "STRONG"
                    )
                  },
                  align: "CENTER"
                ),
                #"SYSTEM_SYSRULES_ButtonLayout"(
                  primaryButtons: #"SYSTEM_SYSRULES_ButtonWidget"(
                    label: "Aceptar",
                    value: false,
                    saveInto: {
                      #"SYSTEM_SYSRULES_startProcess"(
                        processModel: #"_a-0000e9a7-6d42-8000-e63f-01ef9001ef90_5292884",
                        processParameters: {
                          delete: local!eliminar,
                          reporte_aprobado: null,
                          reporte: local!operacionEditada,
                          es_aprobado: false,
                        },
                        onSuccess: "Se ha actualizado la Operación",
                        onError: "Ha ocurrido un error"
                      ),
                      local!mostrarConfirmacion,
                      a!save(local!mostrarExportacion, true),
                      a!save(local!nombre, concat(user(local!usuario, "firstName"), " ",user(local!usuario, "lastName")," username: ", user(local!usuario, "username")))
                    },
                    submit: false,
                    /*validationGroup: "formato_hora",*/
                    style: "PRIMARY"
                  ),
                  secondaryButtons: #"SYSTEM_SYSRULES_ButtonWidget"(
                    label: "Cancelar",
                    value: false,
                    saveInto: {
                      local!mostrarConfirmacion,
                      a!save(ri!operacionesReportes[local!indiceEditar], local!operacionEditar)

                    },
                    submit: false,
                    style: "SECONDARY"
                  )
                )
              },
              height: "AUTO",
              showWhen: local!mostrarConfirmacion,
              style: "INFO",
              shape: "ROUNDED",
              padding: "EVEN_LESS"
            ),
            #"SYSTEM_SYSRULES_cardLayout"(
              contents: {
                #"SYSTEM_SYSRULES_richTextDisplayField"(
                  value: {
                    #"SYSTEM_SYSRULES_richTextItem_v1"(
                      text: "Confirmar cambios",
                      color: "STANDARD",
                      size: "MEDIUM_PLUS"
                    )
                  },
                  align: "CENTER"
                ),
                #"SYSTEM_SYSRULES_richTextDisplayField"(
                  value: {
                    #"SYSTEM_SYSRULES_richTextItem_v1"(
                      text: "Se ha modificado exitosamente",
                      color: "ACCENT",
                      style: "STRONG"
                    )
                  },
                  align: "CENTER"
                ),
                #"SYSTEM_SYSRULES_linkField"(
                  links: #"SYSTEM_SYSRULES_dynamicLink"(
                    label: "Exportar a Excel los cambios (recomendado)",
                    saveInto: {
                      #"SYSTEM_SYSRULES_startProcess"(
                        processModel: #"_a-0000e9a7-6d42-8000-e63f-01ef9001ef90_5434927",
                        processParameters: {
                          reporteId: local!operacionEditar.idreporte,
                          reporteAntiguo: local!operacionEditar,
                          reporteAprobadoAntiguo: null,
                          es_aprobado: false,
                          user: local!nombre,
                        },
                        onSuccess: {
                          a!save(local!excel, fv!processInfo.pv.excel)
                        },
                        onError: "Ha ocurrido un error al exportar"
                      ),
                      
                    }
                  ),
                  align: "CENTER",
                  showWhen: a!isNullOrEmpty(local!excel),
                ),
                #"SYSTEM_SYSRULES_linkField"(
                  align: "CENTER",
                  links: #"SYSTEM_SYSRULES_documentDownloadLink"(
                    label: "Descargar excel",
                    document: local!excel
                  ),
                  showWhen: a!isNotNullOrEmpty(local!excel)
                ),
                #"SYSTEM_SYSRULES_ButtonLayout"(
                  secondaryButtons: {
                    #"SYSTEM_SYSRULES_ButtonWidget"(
                      label: if(a!isNullOrEmpty(local!excel), "No exportar cambios", "Cerrar"),
                      value: false,
                      saveInto: {
                        local!mostrarExportacion,
                        a!save(local!operacionEditar, null),
                        a!save(local!operacionEditada, null),
                        a!save(local!editar, {-1, 0}),
                        a!save(local!indiceEditar,null),
                        a!save(local!excel, null)
                      },
                      submit: false,
                      style: "SECONDARY"
                    )
                  }
                )
              },
              showWhen: local!mostrarExportacion,
              style: "WARN",
              shape: "ROUNDED",
              padding: "EVEN_LESS"
            )
          }
        ),
        #"SYSTEM_SYSRULES_columnLayout"()
      }
    )
  }
  
)</definition>
        <namedTypedValue>
            <name>operacionesReportes</name>
            <type>
                <name>cdo_reportes?list</name>
                <namespace>urn:com:appian:types</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>operacion</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>usuariosopics</name>
            <type>
                <name>cdo_usuariosopics?list</name>
                <namespace>urn:com:appian:types</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>centroCostos</name>
            <type>
                <name>cdo_centroscostos?list</name>
                <namespace>urn:com:appian:types</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
        <isCustom>false</isCustom>
    </interface>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name/>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">#"_a-0000e8d8-9b98-8000-e605-01ef9001ef90_2933354"(operacion: 3784921)</a:value>
                    <a:nameRef>operacionesReportes</a:nameRef>
                    <a:id>1</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">3784921</a:value>
                    <a:nameRef>operacion</a:nameRef>
                    <a:id>2</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">#"_a-0000e878-569a-8000-e5e4-01ef9001ef90_2152641"(usuarioOpic: null()).data,</a:value>
                    <a:nameRef>usuariosopics</a:nameRef>
                    <a:id>3</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">#"_a-0000e94c-78eb-8000-e637-01ef9001ef90_3874604"(idccostos: null).data</a:value>
                    <a:nameRef>centroCostos</a:nameRef>
                    <a:id>4</a:id>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000e9a7-6d42-8000-e63f-01ef9001ef90_5999327"/>
        <historyInfo versionUuid="_a-0000eaa5-8248-8000-e681-01ef9001ef90_8217451"/>
        <historyInfo versionUuid="_a-0000eb09-d442-8000-e687-01ef9001ef90_8848668"/>
        <historyInfo versionUuid="_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9389693"/>
        <historyInfo versionUuid="_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9470546"/>
    </history>
</contentHaul>
