<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000ec5b-dce3-8000-e69f-01ef9001ef90_10135413</versionUuid>
    <interface>
        <name>SCDO_GridAdministradores</name>
        <uuid>_a-0000e878-569a-8000-e5e4-01ef9001ef90_2226554</uuid>
        <description>Interfaz con la tabla para los administradores para SCDO.</description>
        <parentUuid>_a-0000e801-560f-8000-e5d9-01ef9001ef90_1707049</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>a!localVariables(
  /*------------*/
  local!showInformationBanner: true,
  local!showInformationBanner_actualizar: true,
  local!showInformationBanner_eliminar: true,

  /*correcto*/
  local!flag: now(),
  local!showWhen: a!refreshVariable(
    value: now() &lt; local!flag,
    refreshInterval: 0.5
  ),
  /*-----*/

  /*error*/
  local!flag_error: now(),
  local!showWhen_error: a!refreshVariable(
    value: now() &lt; local!flag_error,
    /* especifique el intervalo después de cuántos minutos desea finalizar el examen */
    refreshInterval: 0.5
  ),
  /*------*/

  /*correcto_actualizar*/
  local!flag_actualizar: now(),
  local!showWhen_actualizar: a!refreshVariable(
    value: now() &lt; local!flag_actualizar,
    refreshInterval: 0.5
  ),
  /*-----*/

  /*error_actualizasr*/
  local!flag_error_actualizar: now(),
  local!showWhen_error_actualizar: a!refreshVariable(
    value: now() &lt; local!flag_error_actualizar,
    /* especifique el intervalo después de cuántos minutos desea finalizar el examen */
    refreshInterval: 0.5
  ),
  /*------*/

  /*correcto_eliminar*/
  local!flag_eliminar: now(),
  local!showWhen_eliminar: a!refreshVariable(
    value: now() &lt; local!flag_eliminar,
    refreshInterval: 0.5
  ),
  /*-----*/

  /*error_elimianr*/
  local!flag_error_eliminar: now(),
  local!showWhen_error_eliminar: a!refreshVariable(
    value: now() &lt; local!flag_error_eliminar,
    /* especifique el intervalo después de cuántos minutos desea finalizar el examen */
    refreshInterval: 0.5
  ),
  /*------*/
  /*------------*/
  local!bUser,
  local!succes,
  local!startIndex: 1,
  local!batchSize: 5,
  local!administradorWrite: 'type!{urn:com:appian:types}cdo_administradores'(),
  local!usuarioTecleado,
  local!nombresUsuarioTelceado: if(a!isNullOrEmpty(local!usuarioTecleado), local!usuarioTecleado,
  user(username: tostring(local!usuarioTecleado),property: "firstName")
  ),
  local!existeUsuario: if(
    a!isNullOrEmpty(local!administradorWrite.usuario),
    false,
    if(
      a!isNullOrEmpty(
        index(#"_a-0000e8b3-d748-8000-e5f3-01ef9001ef90_2402181"(usuario: local!administradorWrite.usuario),"data", null)),
      false,
      true
    )
  ),
  local!editGrid,
  local!colorEdit: "#0032E6",
  local!bUserT,
  local!mostrarSuccess: false,
  local!mostrarEliminar: false,
  local!buscarTipo,
  local!colorDV: "#EC0000",
  local!colorSave: "#1F8926",
  local!usuarioNuevo,
  local!emailNuevo,
  local!nombreNuevo,
  local!ApellidosNuevo,



  local!EnviarJson:'type!{urn:com:appian:types}SCDO_CARGA_USUARIOS'(
    username :local!emailNuevo,
    firstName : local!nombreNuevo,
    lastName	:local!ApellidosNuevo,
    email :local!emailNuevo
  ),
  local!resultado,
  local!administradorWriteNuevo: 'type!{urn:com:appian:types}cdo_administradores'(),
  local!administradoresGrid: a!refreshVariable(
    value: #"SYSTEM_SYSRULES_queryEntity_v2"(
      entity: #"_a-0000e8b3-d748-8000-e5f3-01ef9001ef90_2402150",
      query: #"SYSTEM_SYSRULES_query"(
        logicalExpression: {
          #"SYSTEM_SYSRULES_queryLogicalExpression"(
            operator: "AND",
            filters: {
              #"SYSTEM_SYSRULES_queryFilter"(
                field: "tipo",
                operator: "=",
                value: local!buscarTipo,
                applywhen: a!isNotNullOrEmpty(local!buscarTipo)
              )
            },
            logicalexpressions: {
              #"SYSTEM_SYSRULES_queryLogicalExpression"(
                operator: "OR",
                filters: {
                  #"SYSTEM_SYSRULES_queryFilter"(
                    field: "nombre",
                    operator: "includes",
                    value: local!bUser,
                    applywhen: a!isNotNullOrEmpty(local!bUser)
                  ),
                  #"SYSTEM_SYSRULES_queryFilter"(
                    field: "usuario",
                    operator: "includes",
                    value: local!bUser,
                    applywhen: a!isNotNullOrEmpty(local!bUser)
                  ),
                }
              )
            },
            ignoreFiltersWithEmptyValues: true
          ),
        },
        pagingInfo: #"SYSTEM_SYSRULES_pagingInfo"(
          startIndex: local!startIndex,
          batchSize: local!batchSize,
          sort: #"SYSTEM_SYSRULES_sortInfo"(
            field: "idadmon",
            ascending: false
          )
        )
      ),
      fetchTotalCount: true
    ),
    /*refreshAlways: true,*/
    refreshOnVarChange: {ri!refreshCount,local!bUserT,local!bUser}
  ),
  local!administradoreEditar: #"SYSTEM_SYSRULES_forEach"(
    items: index(local!administradoresGrid,"data", null),
    expression: 'type!{urn:com:appian:types}cdo_administradores'(
      idadmon: fv!item.idadmon,
      usuario: fv!item.usuario,
      nombre: fv!item.nombre,
      tipo: fv!item.tipo,
      usuarion: fv!item.usuarion
    )
  ),
  local!administradorSeleccionado,
  local!administradorGuardado,
  local!mostrarUsuarioNuevo:false,
  {
 
    #"SYSTEM_SYSRULES_sectionLayout_v1"(
      contents: {
        #"SYSTEM_SYSRULES_columnsLayout"(
          columns: {
            #"SYSTEM_SYSRULES_columnLayout"(
              contents: {
                #"SYSTEM_SYSRULES_ButtonArrayLayout"(
                  buttons: {
                    #"SYSTEM_SYSRULES_buttonWidget_v1"(
                      label: "Registrar Nuevo Usuario",
                      icon: "user-plus",
                      value: local!mostrarUsuarioNuevo,
                      saveInto: a!save(local!mostrarUsuarioNuevo, not(local!mostrarUsuarioNuevo)),
                      style: "OUTLINE"
                    )
                  },
                  align: "START"
                )
              }
            ),
            /*ERROR*/
            #"SYSTEM_SYSRULES_columnLayout"(
              contents: {
                #"_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9394317"(
                  showInformationBanner: local!showInformationBanner
                )
              },
              showWhen: and(
                local!showInformationBanner,
                local!showWhen_error
              )
            )
          }
        )
      }
    ),
    #"SYSTEM_SYSRULES_boxLayout"(
      label:  if(local!mostrarUsuarioNuevo,"Registrar Nuevo Usuario", "Agregar Nuevo Administrador"),
      contents: if(local!mostrarUsuarioNuevo,
      {
        #"SYSTEM_SYSRULES_cardLayout"(
          contents: {
            #"SYSTEM_SYSRULES_columnsLayout"(
              columns: {
                #"SYSTEM_SYSRULES_columnLayout"(),
                /* Form content */
                #"SYSTEM_SYSRULES_columnLayout"(
                  contents: {
                    #"SYSTEM_SYSRULES_columnsLayout"(
                      columns: {
                        /* Empty column layouts on both sides *
                       * help to center the content         */
                        #"SYSTEM_SYSRULES_columnLayout"(),
                        #"SYSTEM_SYSRULES_columnLayout"(
                          contents: {
                            #"SYSTEM_SYSRULES_sectionLayout_v1"(
                              showWhen: not(#"SYSTEM_SYSRULES_isPageWidth"("PHONE")),
                              marginBelow: "EVEN_MORE"
                            ),
                            #"SYSTEM_SYSRULES_sectionLayout_v1"(
                              label: "Registrar Usuario",
                              labelIcon: "user-plus",
                              labelSize: "LARGE",
                              labelColor: "STANDARD",
                              contents: {
                                #"SYSTEM_SYSRULES_textField"(
                                  label: "Email:",
                                  value: local!emailNuevo,
                                  saveInto: {local!emailNuevo,
                                  local!administradorWriteNuevo.usuarion
                                  },
                                  required: true,
                                  placeholder: "Z123456@santander.com.mx",
                                  requiredMessage: "El campo email es requerido.",
                                  validations: {if(regexmatch("^[a-zA-Z][0-9][a-zA-Z0-9._%+-]*@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$", local!emailNuevo),
                                  {},
                                  "Solo se pueden registrar email que comiencen con una letra seguido de un número"

                                  ),if(isusernametaken(local!emailNuevo), "Este usuario ya existe", {})
                                  },
                                  inputPurpose: "STREET_ADDRESS"
                                ),
                                #"SYSTEM_SYSRULES_textField"(
                                  label: "Nombres:",
                                  value: local!nombreNuevo,
                                  saveInto: local!nombreNuevo,
                                  required: true,
                                  requiredMessage: "El campo nombre es requerido.",
                                 
                                  inputPurpose: "STREET_ADDRESS"
                                ),
                                #"SYSTEM_SYSRULES_textField"(
                                  label: "Apellidos:",
                                  value: local!ApellidosNuevo,
                                  saveInto: local!ApellidosNuevo,
                                  required: true,
                                  requiredMessage: "El campo apellidos es requerido."
                                ),
                                #"SYSTEM_SYSRULES_columnsLayout"(
                                  columns: {
                                    #"SYSTEM_SYSRULES_columnLayout"(
                                      contents: {
                                        #"SYSTEM_SYSRULES_textField"(
                                          label: "Expediente",
                                          value: local!administradorWriteNuevo.usuario,
                                          saveInto: local!administradorWriteNuevo.usuario,
                                          required: true,
                                          requiredMessage: "El campo expediente es requerido."
                                        )
                                      }
                                    )
                                  },
                                  marginBelow: "MORE",
                                  spacing: "DENSE",
                                  stackWhen: {"TABLET_PORTRAIT", "PHONE"}
                                ),
                                #"SYSTEM_SYSRULES_dropdownField_v1"(
                                  choiceLabels: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                                  choiceValues: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                                  label: "Rol",
                                  placeholder: "--- " &amp; "Select" &amp; " ---",
                                  value: local!administradorWriteNuevo.tipo,
                                  saveInto: local!administradorWriteNuevo.tipo,
                                  searchDisplay: "AUTO",
                                  required: true,
                                  requiredMessage: "El campo Rol es requerido."
                                )
                              },
                              divider: "BELOW"
                            ),
                            #"SYSTEM_SYSRULES_columnsLayout"(
                              columns: {
                                #"SYSTEM_SYSRULES_columnLayout"(
                                  contents: {
                                    #"SYSTEM_SYSRULES_ButtonArrayLayout"(
                                      buttons: {
                                        #"SYSTEM_SYSRULES_buttonWidget_v1"(
                                          label: "Cancelar",
                                          value: false,
                                          saveInto: {local!mostrarUsuarioNuevo, 
                                          a!save(local!usuarioNuevo, null),
                                          a!save(local!emailNuevo, null),
                                          a!save(local!nombreNuevo, null),
                                          a!save(local!ApellidosNuevo, null),
                                          a!save(ri!refreshCount, ri!refreshCount + 1),
                                      
                                          a!save(local!administradorWriteNuevo,'type!{urn:com:appian:types}cdo_administradores'())

                                          }
                                        )
                                      },
                                      align: "START"
                                    )
                                  }
                                ),
                                #"SYSTEM_SYSRULES_columnLayout"(
                                  contents: {
                                    #"SYSTEM_SYSRULES_ButtonArrayLayout"(
                                      buttons: {
                                        #"SYSTEM_SYSRULES_buttonWidget_v1"(
                                          label: "Registrar",
                                          saveInto: {
                                            a!save(local!administradorWriteNuevo.nombre, concat(local!nombreNuevo, " ", local!ApellidosNuevo)),


                                            #"SYSTEM_SYSRULES_startProcess"(processModel:#"_a-0000ec31-ac7e-8000-e69b-01ef9001ef90_10049300",
                                            processParameters: {
                                              EnviarJson: local!EnviarJson,
                                              administradores: local!administradorWriteNuevo


                                            },
                                            onSuccess: {a!save(local!resultado, fv!processInfo.pv.Result),
                                            a!save(local!showInformationBanner, true),
                                            if(
                                              toboolean(fv!processInfo.pv.errorBD) = false,
                                              {a!save(local!flag, addseconds(now(), 10)),
                                              a!save(local!succes,fv!processInfo),
                                              a!save(local!bUser,null),
                                              a!save(local!bUserT, null),
                                              a!save(local!usuarioNuevo, null),
                                              a!save(local!emailNuevo, null),
                                              a!save(local!nombreNuevo, null),
                                              a!save(local!ApellidosNuevo, null),
                                              a!save(ri!refreshCount, ri!refreshCount + 1),
                                              a!save(local!administradorGuardado, local!administradorWriteNuevo.usuario),
                                              a!save(local!mostrarSuccess, true),
                                              a!save(local!administradorWriteNuevo,'type!{urn:com:appian:types}cdo_administradores'())

                                              },
                                              a!save(local!flag_error, addseconds(now(), 10))
                                            )
                                            }

                                            ),
                                            a!save(local!mostrarUsuarioNuevo, false)

                                          },


                                          style: "SOLID",
                                          loadingIndicator: true,
                                          validate: true,
                                          validationGroup: "",
                                          confirmMessage: "¿Está seguro de agregar este registro?"
                                        )
                                      }
                                    )
                                  }
                                )
                              }
                            )
                          },
                          width: "MEDIUM_PLUS"
                        )
                      }
                    )
                  }
                ),
                /* Additional details content */
                #"SYSTEM_SYSRULES_columnLayout"(
                  contents: {},
                  width: if(
                    #"SYSTEM_SYSRULES_isPageWidth"("TABLET_PORTRAIT"),
                    "NARROW_PLUS",
                    "MEDIUM"
                  ),
                  showWhen: not(#"SYSTEM_SYSRULES_isPageWidth"("PHONE"))
                )
              },
              showWhen: local!mostrarUsuarioNuevo
            )
          },
          padding: if(
            #"SYSTEM_SYSRULES_isPageWidth"("PHONE"),
            "STANDARD",
            "NONE"
          ),
          marginBelow: "NONE",
          showBorder: false
        )
      },
      {

        #"SYSTEM_SYSRULES_sideBySideLayout"(
          items: {
            #"SYSTEM_SYSRULES_sideBySideItem"(
              item: #"SYSTEM_SYSRULES_pickerFieldUsers"(
                label: "Usuario N:",
                labelPosition: "ADJACENT",
                maxSelections: 1,
                value: local!administradorWrite.usuarion,
                saveInto: {
                  local!usuarioTecleado,
                  local!administradorWrite.usuarion

                },
                validations: {}
              )
            ),
            #"SYSTEM_SYSRULES_sideBySideItem"(
              item: #"SYSTEM_SYSRULES_textField"(
                label: "Expediente:",
                labelPosition: "ADJACENT",
                value: local!administradorWrite.usuario,
                saveInto: {
                  a!save(
                    local!administradorWrite.usuario,
                    (save!value)
                  )
                },
                refreshAfter :"KEYPRESS",
                validations: {},
                align: "LEFT"
              )
            ),
            #"SYSTEM_SYSRULES_sideBySideItem"(
              item: #"SYSTEM_SYSRULES_textField"(
                label: "Nombre:",
                labelPosition: "ADJACENT",
                
                value: local!nombresUsuarioTelceado,
                saveInto: {
                  a!save(local!nombresUsuarioTelceado, save!value),
                  
                  a!save(
                    local!administradorWrite.nombre,
                    trim((save!value))
                  )  
                },
                refreshAfter :"KEYPRESS",
                validations: {},
                align: "LEFT",
                inputPurpose: "NAME"
              )
            )
          }
        ),
        #"SYSTEM_SYSRULES_sideBySideLayout"(
          items: {
            #"SYSTEM_SYSRULES_sideBySideItem"(
              item: #"SYSTEM_SYSRULES_dropdownField_v1"(
                choiceLabels: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                choiceValues: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                label: "Tipo:",
                labelPosition: "ADJACENT",
                placeholder: "--- Seleccione un valor ---",
                value: local!administradorWrite.tipo,
                saveInto: {
                  local!administradorWrite.tipo
                },
                searchDisplay: "AUTO",
                validations: {}
              )
            )
          }
        ),
        #"SYSTEM_SYSRULES_columnsLayout"(
          columns: {
            #"SYSTEM_SYSRULES_columnLayout"(
              contents: {
                #"SYSTEM_SYSRULES_ButtonArrayLayout"(
                  buttons: {
                    #"SYSTEM_SYSRULES_buttonWidget_v1"(
                      label: "Agregar",
                      disabled: or(local!existeUsuario, a!isNullOrEmpty(local!administradorWrite.usuarion),a!isNullOrEmpty(local!administradorWrite.usuario),a!isNullOrEmpty(local!nombresUsuarioTelceado), a!isNullOrEmpty(local!administradorWrite.tipo)),
                      saveInto: {
                        #"SYSTEM_SYSRULES_startProcess"(
                          processModel: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2484911",
                          processParameters: {
                            administradores: local!administradorWrite,
                            delete: false,
                            codAudit:"CDO_0006",
                            accion:"insertó"
                          },
                          onSuccess: {
                            a!save(local!showInformationBanner, true),
                            if(
                              toboolean(fv!processInfo.pv.error) = false,
                              {a!save(local!flag, addseconds(now(), 10)),
                              a!save(local!succes,fv!processInfo),
                              a!save(local!bUser,null),
                              a!save(local!bUserT, null),
                              a!save(ri!refreshCount, ri!refreshCount + 1),
                              a!save(local!administradorGuardado, local!administradorWrite.usuario),
                              a!save(local!usuarioTecleado, null),
                              a!save(local!mostrarSuccess, true),
                              a!save(local!administradorWrite,'type!{urn:com:appian:types}cdo_administradores'())

                              },
                              a!save(local!flag_error, addseconds(now(), 10))
                            )
                            /*a!save(local!succes,fv!processInfo),*/
                            /*a!save(local!bUser,null),*/
                            /*a!save(local!bUserT, null),*/
                            /*a!save(ri!refreshCount, ri!refreshCount + 1),*/
                            /*a!save(local!administradorGuardado, local!administradorWrite.usuario),*/
                            /*a!save(local!mostrarSuccess, true),*/
                            /*a!save(local!administradorWrite,'type!{urn:com:appian:types}cdo_administradores'())*/
/*                          */
                          }
                        )
                      },
                      size: "SMALL",
                      icon: "save",
                      loadingIndicator: true
                    )
                  },
                  align: "CENTER",
                  marginAbove: "EVEN_LESS",
                  marginBelow: "EVEN_LESS"
                )
              }
            )
          }
        ),
        #"SYSTEM_SYSRULES_columnsLayout"(
          columns: {
            #"SYSTEM_SYSRULES_columnLayout"(
              contents: {
                #"SYSTEM_SYSRULES_richTextDisplayField"(
                  value: {
                    #"SYSTEM_SYSRULES_richTextItem_v1"(
                      text: concat(
                        "Faltan por llenar los siguientes campos: ", char(10),
                        if(
                          a!isNullOrEmpty(local!administradorWrite.usuarion),
                          concat("* Usuario N", char(10)),
                          null
                        ),
                        if(
                          a!isNullOrEmpty(local!administradorWrite.usuario),
                          concat("* Usuario", char(10)),
                          null
                        ),
                        if(
                          a!isNullOrEmpty(local!nombresUsuarioTelceado),
                          concat("* Nombre", char(10)),
                          null
                        ),
                        if(
                          a!isNullOrEmpty(local!administradorWrite.tipo),
                          concat("* Tipo", char(10)),
                          null
                        )
                      ),
                      color: "NEGATIVE"
                    )
                  },
                  showWhen: or(a!isNullOrEmpty(local!administradorWrite.usuarion),a!isNullOrEmpty(local!administradorWrite.usuario), a!isNullOrEmpty(local!nombresUsuarioTelceado), a!isNullOrEmpty(local!administradorWrite.tipo))
                )
              }
            ),
            #"SYSTEM_SYSRULES_columnLayout"(
              contents: {
                #"SYSTEM_SYSRULES_cardLayout"(
                  contents: {
                    #"SYSTEM_SYSRULES_richTextDisplayField"(
                      value: {
                        #"SYSTEM_SYSRULES_richTextItem_v1"(
                          text: concat("Se ha insertado correctamente el usuario: ", local!administradorGuardado),
                          color: "ACCENT",
                          style: "STRONG"
                        )
                      },
                      align: "CENTER"
                    ),
                    #"SYSTEM_SYSRULES_ButtonArrayLayout"(
                      buttons: {
                        #"SYSTEM_SYSRULES_buttonWidget_v1"(
                          label: "ACEPTAR",
                          style: "SOLID",
                          value: false,
                          saveInto: {{local!mostrarSuccess, local!showInformationBanner}, a!save(local!administradorGuardado, null)},
                          size: "SMALL",
                          icon: "check"
                        )
                      },
                      align: "CENTER"
                    )
                  },
                  /*showWhen: local!mostrarSuccess,*/
                  showWhen: and(
                    local!showInformationBanner,
                    local!showWhen
                  ),
                  style: "SUCCESS",
                  showBorder: false
                )
              }
            )
          }
        )
      }),
      padding: "MORE",
      marginBelow: "MORE"
   ),
   

  
  #"SYSTEM_SYSRULES_sectionLayout_v1"(
    label: "",
    contents: {
      #"SYSTEM_SYSRULES_richTextDisplayField"(
        labelPosition: "COLLAPSED",
        instructions: "",
        value: {
          "Muestra lista de administradores de CDO así como contraseña y tipo de usuario con las opciones de Eliminar, Modificar o Agregar"
        },
        align: "LEFT"
      ),
      #"SYSTEM_SYSRULES_columnsLayout"(
        columns: {
          /*CORRECTO ACTUALIZAR*/
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9394093"(
                showInformationBanner: local!showInformationBanner_actualizar
              )
            },
            showWhen: and(
              local!showInformationBanner_actualizar,
              local!showWhen_actualizar
            )
          ),
          /*ERROR ACTUALIZAR*/
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9394317"(
                showInformationBanner: local!showInformationBanner_actualizar
              )
            },
            showWhen: and(
              local!showInformationBanner_actualizar,
              local!showWhen_error_actualizar
            )
          ),
          /*CORRECTO ELIMINAR*/
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9394093"(
                showInformationBanner: local!showInformationBanner_eliminar
              )
            },
            showWhen: and(
              local!showInformationBanner_eliminar,
              local!showWhen_eliminar
            )
          ),
          /*ERROR ELIMINAR*/
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9394317"(
                showInformationBanner: local!showInformationBanner_eliminar
              )
            },
            showWhen: and(
              local!showInformationBanner_eliminar,
              local!showWhen_error_eliminar
            )
          )
        }
      ),
      #"SYSTEM_SYSRULES_columnsLayout"(
        columns: {
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"SYSTEM_SYSRULES_textField"(
                label: "Buscar por Usuario:",
                labelPosition: "ADJACENT",
                value: local!bUserT,
                saveInto: {
                  local!bUserT,
                  a!save(local!editGrid, null)
                },
                refreshAfter: "KEYPRESS",
                validations: {}
              )
            }
          ),
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"SYSTEM_SYSRULES_ButtonArrayLayout"(
                buttons: {
                  #"SYSTEM_SYSRULES_buttonWidget_v1"(
                    label: "Buscar",
                    style : "GHOST",
                    saveInto: {a!save(local!bUser,local!bUserT), a!save(local!editGrid, null),
                    a!save(
                      local!startIndex,
                      1
                    )},
                    size: "SMALL",
                    icon: "search",
                    loadingIndicator: true
                  )
                },
                align: "START"
              )
            },
            width: "NARROW"
          ),
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"SYSTEM_SYSRULES_dropdownField_v1"(
                choiceLabels: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                choiceValues: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                label: "Buscar Por Tipo:",
                labelPosition: "ADJACENT",
                placeholder: "--- Seleccione un valor ---",
                value: local!buscarTipo,
                saveInto: {
                  local!buscarTipo,
                  a!save(local!editGrid, null)
                },
                searchDisplay: "AUTO",
                validations: {}
              )
            }
          ),
          #"SYSTEM_SYSRULES_columnLayout"()
        }
      ),
      
      #"SYSTEM_SYSRULES_columnsLayout"(
        columns: {
          #"SYSTEM_SYSRULES_columnLayout"(),
          #"SYSTEM_SYSRULES_columnLayout"(),
          #"SYSTEM_SYSRULES_columnLayout"(
            contents: {
              #"SYSTEM_SYSRULES_cardLayout"(
                contents: {
                  #"SYSTEM_SYSRULES_richTextDisplayField"(
                    value: {
                      #"SYSTEM_SYSRULES_richTextItem_v1"(
                        text: "¿Está seguro que desea eliminar al usuario: "&amp;local!administradorSeleccionado.usuario &amp;"?"&amp;char(10)&amp;"La acción es irrevocable",
                        color: "NEGATIVE",
                        style: "STRONG"
                      )
                    },
                    align: "CENTER"
                  ),
                  #"SYSTEM_SYSRULES_ButtonLayout"(
                    primaryButtons: {
                      #"SYSTEM_SYSRULES_buttonWidget_v1"(
                        label: "Sí, Eliminar",
                        style: "GHOST",
                        saveInto: {
                          #"SYSTEM_SYSRULES_startProcess"(
                            processModel: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2484911",
                            processParameters: { administradores: local!administradorSeleccionado, delete: true ,
                           },
                            onSuccess: {
                              a!save(local!showInformationBanner_eliminar, true),
                              if(
                                toboolean(fv!processInfo.pv.error) = false,
                                {a!save(local!flag_eliminar, addseconds(now(), 10)),
                                a!save(local!buscarTipo,null),
                                a!save(local!bUser,null),
                                a!save(local!bUserT,null),
                                a!save(local!administradorSeleccionado, null),
                                a!save(ri!refreshCount, ri!refreshCount + 1)
                                
                                },
                                a!save(local!flag_error_eliminar, addseconds(now(), 10))
                              ),
                              a!save(local!mostrarEliminar, false)
                              /*a!save(local!buscarTipo,null),*/
                              /*a!save(local!bUser,null),*/
                              /*a!save(local!bUserT,null),*/
                              /*a!save(local!administradorSeleccionado, null),*/
                              /*a!save(ri!refreshCount, ri!refreshCount + 1),*/
                              /*a!save(local!mostrarEliminar, false)*/
                            }
                          )
                        },
                        size: "SMALL",
                        icon: "trash",
                        loadingIndicator: true
                      )
                    },
                    secondaryButtons: {
                      #"SYSTEM_SYSRULES_buttonWidget_v1"(
                        label: "Cancelar",
                        style: "GHOST",
                        saveInto: {
                          a!save(local!mostrarEliminar, false),
                          a!save(local!editGrid, null),
                          a!save(local!administradorSeleccionado, null)
                        },
                        size: "SMALL",
                        icon: "times"
                      )
                    }
                  )
                },
                style: "WARN",
                showBorder: false
              )
            }
          )
        },
        showWhen: local!mostrarEliminar
      ),
      #"SYSTEM_SYSRULES_gridLayout"(
        label: "Tabla de Administradores",
        labelPosition: "ABOVE",
        headerCells: {
          #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(label: "USUARION", align: "CENTER"),
          #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(label: "USUARIO", align: "CENTER"),
          #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(label: "NOMBRE", align: "CENTER"),
          #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(label: "TIPO", align: "CENTER"),
          #"SYSTEM_SYSRULES_gridLayoutHeaderCell"(label: "ACCIONES", align: "CENTER")
        },
        columnConfigs: {
          #"SYSTEM_SYSRULES_gridLayoutColumnConfig"(),
          #"SYSTEM_SYSRULES_gridLayoutColumnConfig"(weight: 2)
        },
        rows: {
          #"SYSTEM_SYSRULES_forEach"(
            items: index(local!administradoresGrid,"data", null),
            expression: #"SYSTEM_SYSRULES_gridRowLayout"(
              contents: {
                #"SYSTEM_SYSRULES_textField"(
                  value: local!administradoreEditar[fv!index].usuarion,
                  saveInto: {
                    local!administradoreEditar[fv!index].usuarion
                  },
                  refreshAfter:"KEYPRESS",
                  readOnly: if(
                    a!isNullOrEmpty(local!editGrid),
                    true,
                    if(
                      local!editGrid = fv!index,
                      false,
                      true
                    )
                  ),
                  align: "CENTER"
                ),
              
                #"SYSTEM_SYSRULES_textField"(
                  value: local!administradoreEditar[fv!index].usuario,
                  saveInto: {
                    local!administradoreEditar[fv!index].usuario
                  },
                  refreshAfter:"KEYPRESS",
                  readOnly: if(
                    a!isNullOrEmpty(local!editGrid),
                    true,
                    if(
                      local!editGrid = fv!index,
                      false,
                      true
                    )
                  ),
                  align: "CENTER"
                ),
                #"SYSTEM_SYSRULES_textField"(
                  value: local!administradoreEditar[fv!index].nombre,
                  saveInto: {
                    local!administradoreEditar[fv!index].nombre
                  },
                  refreshAfter:"KEYPRESS",
                  readOnly: if(
                    a!isNullOrEmpty(local!editGrid),
                    true,
                    if(
                      local!editGrid = fv!index,
                      false,
                      true
                    )
                  ),
                  align: "CENTER"

                ),
                #"SYSTEM_SYSRULES_dropdownField_v1"(
                  choiceLabels: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                  choiceValues: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2453274",
                  placeholder: "--- Seleccione un valor ---",
                  value: local!administradoreEditar[fv!index].tipo,
                  saveInto: {
                    local!administradoreEditar[fv!index].tipo
                  },
                  searchDisplay: "AUTO",
                  disabled: if(
                    a!isNullOrEmpty(local!editGrid),
                    true,
                    if(
                      local!editGrid = fv!index,
                      false,
                      true
                    )
                  )
                ),
                #"SYSTEM_SYSRULES_richTextDisplayField"(
                  value: {
                    #"SYSTEM_SYSRULES_richTextIcon"(
                      icon: "pencil-square-o",
                      caption: "Editar",
                      link: #"SYSTEM_SYSRULES_dynamicLink"(
                        saveInto: { 
                          a!save(local!editGrid, fv!index),
                          a!save(local!administradorSeleccionado, 'type!{urn:com:appian:types}cdo_administradores'(idadmon: fv!item.idadmon, usuario: fv!item.usuario, nombre: fv!item.nombre, tipo: fv!item.tipo, usuarion: fv!item.usuarion))
                        }
                      ),
                      linkStyle: "STANDALONE",
                      showWhen: and(a!isNullOrEmpty(local!editGrid), not(local!mostrarEliminar)),
                      color: local!colorEdit
                    ),
                    #"SYSTEM_SYSRULES_richTextIcon"(
                      icon: "pencil-square-o",
                      caption: "Descartar Cambios",
                      link: #"SYSTEM_SYSRULES_dynamicLink"(
                        saveInto: { 
                          a!save(local!editGrid, null),
                          a!save(ri!refreshCount, ri!refreshCount + 1),
                          a!save(local!administradoreEditar[fv!index], local!administradorSeleccionado),
                          a!save(local!administradorSeleccionado, null)
                        }
                      ),
                      linkStyle: "STANDALONE",
                      showWhen: if(
                        a!isNotNullOrEmpty(local!editGrid),
                        and(local!editGrid = fv!index, not(local!mostrarEliminar)),
                        false
                      ),
                      color: "#222222"
                    ),
                    #"SYSTEM_SYSRULES_richTextIcon"(
                      icon: "file-invoice",
                      caption: "Actualizar",
                      link: #"SYSTEM_SYSRULES_dynamicLink"(
                        saveInto: {
                          #"SYSTEM_SYSRULES_startProcess"(
                            processModel: #"_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2484911",
                            processParameters: {
                              administradores: local!administradoreEditar[fv!index], 
                              delete: false ,
                              codAudit:"CDO_0004",
                              accion:"actualizó"
                            },
                            onSuccess: {
                              a!save(local!showInformationBanner_actualizar, true),
                              if(
                                toboolean(fv!processInfo.pv.error) = false,
                                {a!save(local!flag_actualizar, addseconds(now(), 10)),
                                a!save(local!buscarTipo,null),
                                a!save(local!bUser,null),
                                a!save(local!bUserT,null),
                                a!save(local!succes, fv!processInfo),
                                a!save(local!editGrid, null),
                                a!save(local!administradorSeleccionado, null),
                                a!save(ri!refreshCount, ri!refreshCount + 1)
                                },
                                a!save(local!flag_error_actualizar, addseconds(now(), 10))
                              )
                              /*a!save(local!buscarTipo,null),*/
                              /*a!save(local!bUser,null),*/
                              /*a!save(local!bUserT,null),*/
                              /*a!save(local!succes, fv!processInfo),*/
                              /*a!save(local!editGrid, null),*/
                              /*a!save(local!administradorSeleccionado, null),*/
                              /*a!save(ri!refreshCount, ri!refreshCount + 1)*/
                            }
                          )
                        }
                      ),
                      linkStyle: "STANDALONE",
                      showWhen: 
                      if(
                        a!isNullOrEmpty(local!editGrid),
                        false,
                        if(
                          and(
                            local!editGrid = fv!index,
                            local!administradoreEditar[fv!index] &lt;&gt; local!administradorSeleccionado
                            
                          ),
                          true,
                          false
                        )
                      ),
                      /*if(*/
                        /*a!isNullOrEmpty(local!editGrid),*/
                        /*false,*/
                        /*if(*/
                          /*and(local!editGrid = fv!index, not(local!mostrarEliminar)),*/
                          /*if(*/
                            /*or(a!isNullOrEmpty(fv!item.usuario), a!isNullOrEmpty(fv!item.nombre), a!isNullOrEmpty(fv!item.tipo), a!isNullOrEmpty(fv!item.password),a!isNullOrEmpty(fv!item.usuarion)),*/
                            /*false,*/
                            /*if(*/
                              /*local!administradoreEditar[fv!index] &lt;&gt; local!administradorSeleccionado,*/
                              /*true,*/
                              /*false*/
                            /*)*/
                          /*),*/
                          /*false()*/
                        /*)*/
                      /*),*/
                      color: local!colorSave
                    ),
                    #"SYSTEM_SYSRULES_richTextIcon"(
                      icon: "times",
                      caption: "Eliminar Usuario",
                      link: #"SYSTEM_SYSRULES_dynamicLink"(
                        saveInto: {
                          a!save(local!mostrarEliminar, true),
                          a!save(local!administradorSeleccionado, 'type!{urn:com:appian:types}cdo_administradores'(idadmon: fv!item.idadmon, usuario: fv!item.usuario, nombre: fv!item.nombre, tipo: fv!item.tipo,usuarion: fv!item.usuarion))
                        }
                      ),
                      linkStyle: "STANDALONE",
                      showWhen: if(
                        and(a!isNullOrEmpty(local!editGrid), not(local!mostrarEliminar)),
                        true,
                        if(
                          a!isNotNullOrEmpty(local!editGrid),
                          and(local!editGrid = fv!index, not(local!mostrarEliminar)),
                          false
                        )
                      ),
                      color: local!colorDV
                    )
                  },
                  align: "CENTER"
                )
              }
            )
          )
        },
        selectionSaveInto: {},
        validations: {},
        shadeAlternateRows: true
      ),
      #"SYSTEM_SYSRULES_richTextDisplayField"(
        labelPosition: "COLLAPSED",
        value: {
          #"SYSTEM_SYSRULES_richTextIcon"(
            icon: "angle-double-left",
            link: #"SYSTEM_SYSRULES_dynamicLink"(
              saveInto: {
                a!save(
                  local!startIndex,
                  1
                )
              },
              showWhen: not(local!startIndex = 1)
            ),
            linkStyle: "STANDALONE",
            size: "MEDIUM_PLUS"
          ),
          #"SYSTEM_SYSRULES_richTextIcon"(
            icon: "angle-left",
            link: #"SYSTEM_SYSRULES_dynamicLink"(
              saveInto: {
                a!save(
                  local!startIndex,
                  tointeger(local!startIndex - 5)
                )    
              },
              showWhen: not(local!startIndex = 1)
            ),
            linkStyle: "STANDALONE",
            size: "MEDIUM_PLUS"
          ),
          #"SYSTEM_SYSRULES_richTextItem_v1"(
            text: {
              #"SYSTEM_SYSRULES_richTextItem_v1"(
                text: {
                  if(local!administradoresGrid.totalCount = 0, 0, local!startIndex) &amp; " - " &amp; if(local!startIndex + 4 &gt; local!administradoresGrid.totalCount, local!administradoresGrid.totalCount, local!startIndex+4)
                },
                style: {
                  "STRONG"
                }
              ),
              " de " &amp; local!administradoresGrid.totalCount
            },
            size: "STANDARD"
          ),
          #"SYSTEM_SYSRULES_richTextIcon"(
            icon: "angle-right",
            link: #"SYSTEM_SYSRULES_dynamicLink"(
              saveInto: {
                a!save(
                  local!startIndex,
                  tointeger(local!startIndex + 5)
                )
              },
              showWhen: (local!startIndex + 4) &lt; local!administradoresGrid.totalCount
            ),
            linkStyle: "STANDALONE",
            size: "MEDIUM_PLUS"
          ),
          #"SYSTEM_SYSRULES_richTextIcon"(
            icon: "angle-double-right",
            link: #"SYSTEM_SYSRULES_dynamicLink"(
              saveInto: {
                a!save(
                  local!startIndex,
                  tointeger(local!administradoresGrid.totalCount - tointeger(right(local!administradoresGrid.totalCount)) + 1)
                )
              },
              showWhen: (local!startIndex + 4) &lt; local!administradoresGrid.totalCount
            ),
            linkStyle: "STANDALONE",
            size: "MEDIUM_PLUS"
          )
        },
        align: "RIGHT"
      )
    },
    divider: "ABOVE"
  )
    
    
}
)</definition>
        <namedTypedValue>
            <name>refreshCount</name>
            <type>
                <name>double</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
        <isCustom>false</isCustom>
    </interface>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <history>
        <historyInfo versionUuid="_a-0000e8b9-0989-8000-e5fd-01ef9001ef90_2485035"/>
        <historyInfo versionUuid="_a-0000ea3c-477e-8000-e648-01ef9001ef90_6934358"/>
        <historyInfo versionUuid="_a-0000eabf-35e2-8000-e683-01ef9001ef90_8451806"/>
        <historyInfo versionUuid="_a-0000eb09-d442-8000-e687-01ef9001ef90_8807189"/>
        <historyInfo versionUuid="_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9395615"/>
        <historyInfo versionUuid="_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9450118"/>
        <historyInfo versionUuid="_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9500620"/>
        <historyInfo versionUuid="_a-0000eb53-0a0e-8000-e689-01ef9001ef90_9543048"/>
        <historyInfo versionUuid="_a-0000ec5b-dce3-8000-e69f-01ef9001ef90_10135413"/>
    </history>
</contentHaul>
